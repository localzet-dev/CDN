{"version":3,"file":"settings.js","names":["KTAppEcommerceSettings","init","forEach","formId","form","document","getElementById","requiredFields","querySelectorAll","detectedField","validationFields","fields","plugins","trigger","FormValidation","Trigger","bootstrap","Bootstrap5","rowSelector","eleInvalidClass","eleValidClass","el","input","closest","querySelector","textarea","select","name","getAttribute","validators","notEmpty","message","innerText","validator","formValidation","submitButton","addEventListener","e","preventDefault","validate","then","status","console","log","setAttribute","disabled","setTimeout","removeAttribute","Swal","fire","text","icon","buttonsStyling","confirmButtonText","customClass","confirmButton","element","Tagify","optionFormat","item","id","span","createElement","template","innerHTML","$","select2","placeholder","minimumResultsForSearch","Infinity","templateSelection","templateResult","initSelect2Flags","KTUtil","onDOMContentLoaded"],"sources":["apps/ecommerce/settings/settings.js"],"mappings":"AAAA,aAGA,IAAIA,uBA0KO,CACHC,KAAM,WArKQ,CACV,qCACA,sCACA,6CACA,yCACA,2CAIEC,SAAQC,IAEV,MAAMC,EAAOC,SAASC,eAAeH,GAErC,IAAIC,EACA,OAIJ,MAAMG,EAAiBH,EAAKI,iBAAiB,aAC7C,IAAIC,EACAC,EAAmB,CACnBC,OAAQ,CAAC,EAETC,QAAS,CACLC,QAAS,IAAIC,eAAeF,QAAQG,QACpCC,UAAW,IAAIF,eAAeF,QAAQK,WAAW,CAC7CC,YAAa,UACbC,gBAAiB,GACjBC,cAAe,OAM3Bb,EAAeL,SAAQmB,IACnB,MAAMC,EAAQD,EAAGE,QAAQ,QAAQC,cAAc,SAC3CF,IACAb,EAAgBa,GAGpB,MAAMG,EAAWJ,EAAGE,QAAQ,QAAQC,cAAc,YAC9CC,IACAhB,EAAgBgB,GAGpB,MAAMC,EAASL,EAAGE,QAAQ,QAAQC,cAAc,UAC5CE,IACAjB,EAAgBiB,GAIpB,MAAMC,EAAOlB,EAAcmB,aAAa,QACxClB,EAAiBC,OAAOgB,GAAQ,CAC5BE,WAAY,CACRC,SAAU,CACNC,QAASV,EAAGW,UAAY,iBAGpC,IAIJ,IAAIC,EAAYnB,eAAeoB,eAC3B9B,EACAM,GAIJ,MAAMyB,EAAe/B,EAAKoB,cAAc,8CACxCW,EAAaC,iBAAiB,SAAS,SAAUC,GAE7CA,EAAEC,iBAGEL,GACAA,EAAUM,WAAWC,MAAK,SAAUC,GAChCC,QAAQC,IAAI,cAEE,SAAVF,GAEAN,EAAaS,aAAa,oBAAqB,MAG/CT,EAAaU,UAAW,EAGxBC,YAAW,WAEPX,EAAaY,gBAAgB,qBAG7BZ,EAAaU,UAAW,EAGxBG,KAAKC,KAAK,CACNC,KAAM,wCACNC,KAAM,UACNC,gBAAgB,EAChBC,kBAAmB,cACnBC,YAAa,CACTC,cAAe,oBAK3B,GAAG,MAGHP,KAAKC,KAAK,CACNC,KAAM,0CACNC,KAAM,QACNC,gBAAgB,EAChBC,kBAAmB,cACnBC,YAAa,CACTC,cAAe,oBAI/B,GAER,GAAE,IAOWlD,SAASG,iBAAiB,8CAGlCN,SAAQsD,IACb,IAAIC,OAAOD,EAAQ,IAKF,MAErB,MAAME,EAAgBC,IAClB,IAAMA,EAAKC,GACP,OAAOD,EAAKT,KAGhB,IAAIW,EAAOxD,SAASyD,cAAc,QAC9BC,EAAW,GAOf,OALAA,GAAY,aAAeJ,EAAKH,QAAQ5B,aAAa,2BAA6B,qDAClFmC,GAAYJ,EAAKT,KAEjBW,EAAKG,UAAYD,EAEVE,EAAEJ,EAAK,EAIlBI,EAAE,qDAAqDC,QAAQ,CAC3DC,YAAa,mBACbC,wBAAyBC,IACzBC,kBAAmBZ,EACnBa,eAAgBb,GAClB,EASEc,EAEJ,GAKRC,OAAOC,oBAAmB,WACtB1E,uBAAuBC,MAC3B","sourcesContent":["\"use strict\";\r\n\r\n// Class definition\r\nvar KTAppEcommerceSettings = function () {\r\n    // Shared variables\r\n\r\n\r\n    // Private functions\r\n    const initForms = () => {\r\n        const forms = [\r\n            'kt_ecommerce_settings_general_form',\r\n            'kt_ecommerce_settings_general_store',\r\n            'kt_ecommerce_settings_general_localization',\r\n            'kt_ecommerce_settings_general_products',\r\n            'kt_ecommerce_settings_general_customers',\r\n        ];\r\n\r\n        // Init all forms\r\n        forms.forEach(formId => {\r\n            // Select form\r\n            const form = document.getElementById(formId);\r\n\r\n            if(!form){\r\n                return;\r\n            }\r\n\r\n            // Dynamically create validation non-empty rule\r\n            const requiredFields = form.querySelectorAll('.required');\r\n            var detectedField;\r\n            var validationFields = {\r\n                fields: {},\r\n\r\n                plugins: {\r\n                    trigger: new FormValidation.plugins.Trigger(),\r\n                    bootstrap: new FormValidation.plugins.Bootstrap5({\r\n                        rowSelector: '.fv-row',\r\n                        eleInvalidClass: '',\r\n                        eleValidClass: ''\r\n                    })\r\n                }\r\n            }\r\n\r\n            // Detect required fields\r\n            requiredFields.forEach(el => {\r\n                const input = el.closest('.row').querySelector('input');\r\n                if (input) {\r\n                    detectedField = input;\r\n                }\r\n\r\n                const textarea = el.closest('.row').querySelector('textarea');\r\n                if (textarea) {\r\n                    detectedField = textarea;\r\n                }\r\n\r\n                const select = el.closest('.row').querySelector('select');\r\n                if (select) {\r\n                    detectedField = select;\r\n                }\r\n\r\n                // Add validation rule                \r\n                const name = detectedField.getAttribute('name');\r\n                validationFields.fields[name] = {\r\n                    validators: {\r\n                        notEmpty: {\r\n                            message: el.innerText + ' is required'\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            // Init form validation rules. For more info check the FormValidation plugin's official documentation:https://formvalidation.io/\r\n            var validator = FormValidation.formValidation(\r\n                form,\r\n                validationFields\r\n            );\r\n\r\n            // Submit button handler\r\n            const submitButton = form.querySelector('[data-kt-ecommerce-settings-type=\"submit\"]');\r\n            submitButton.addEventListener('click', function (e) {\r\n                // Prevent default button action\r\n                e.preventDefault();\r\n\r\n                // Validate form before submit\r\n                if (validator) {\r\n                    validator.validate().then(function (status) {\r\n                        console.log('validated!');\r\n\r\n                        if (status == 'Valid') {\r\n                            // Show loading indication\r\n                            submitButton.setAttribute('data-kt-indicator', 'on');\r\n\r\n                            // Disable button to avoid multiple click \r\n                            submitButton.disabled = true;\r\n\r\n                            // Simulate form submission. For more info check the plugin's official documentation: https://sweetalert2.github.io/\r\n                            setTimeout(function () {\r\n                                // Remove loading indication\r\n                                submitButton.removeAttribute('data-kt-indicator');\r\n\r\n                                // Enable button\r\n                                submitButton.disabled = false;\r\n\r\n                                // Show popup confirmation \r\n                                Swal.fire({\r\n                                    text: \"Form has been successfully submitted!\",\r\n                                    icon: \"success\",\r\n                                    buttonsStyling: false,\r\n                                    confirmButtonText: \"Ok, got it!\",\r\n                                    customClass: {\r\n                                        confirmButton: \"btn btn-primary\"\r\n                                    }\r\n                                });\r\n\r\n                                //form.submit(); // Submit form\r\n                            }, 2000);\r\n                        } else {\r\n                            // Show popup error \r\n                            Swal.fire({\r\n                                text: \"Oops! There are some error(s) detected.\",\r\n                                icon: \"error\",\r\n                                buttonsStyling: false,\r\n                                confirmButtonText: \"Ok, got it!\",\r\n                                customClass: {\r\n                                    confirmButton: \"btn btn-primary\"\r\n                                }\r\n                            });\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    // Init Tagify\r\n    const initTagify = () => {\r\n        // Get tagify elements\r\n        const elements = document.querySelectorAll('[data-kt-ecommerce-settings-type=\"tagify\"]');\r\n\r\n        // Init tagify\r\n        elements.forEach(element => {\r\n            new Tagify(element);\r\n        });\r\n    }\r\n\r\n    // Init Select2 with flags\r\n    const initSelect2Flags = () => {\r\n        // Format options\r\n        const optionFormat = (item) => {\r\n            if ( !item.id ) {\r\n                return item.text;\r\n            }\r\n\r\n            var span = document.createElement('span');\r\n            var template = '';\r\n\r\n            template += '<img src=\"' + item.element.getAttribute('data-kt-select2-country') + '\" class=\"rounded-circle h-20px me-2\" alt=\"image\"/>';\r\n            template += item.text;\r\n\r\n            span.innerHTML = template;\r\n\r\n            return $(span);\r\n        }\r\n\r\n        // Init Select2 --- more info: https://select2.org/\r\n        $('[data-kt-ecommerce-settings-type=\"select2_flags\"]').select2({\r\n            placeholder: \"Select a country\",\r\n            minimumResultsForSearch: Infinity,\r\n            templateSelection: optionFormat,\r\n            templateResult: optionFormat\r\n        });\r\n    }\r\n\r\n    // Public methods\r\n    return {\r\n        init: function () {\r\n\r\n            initForms();\r\n            initTagify();\r\n            initSelect2Flags();\r\n\r\n        }\r\n    };\r\n}();\r\n\r\n// On document ready\r\nKTUtil.onDOMContentLoaded(function () {\r\n    KTAppEcommerceSettings.init();\r\n});\r\n"]}