"use strict";var LoginAuth=function(){var e,t,r,o,n,a,i,s,d,l,c=function(e,t){t.forEach((t=>{t===e?t.classList.add("active"):t.classList.remove("active")}))},u=function(e,t){t.forEach((t=>{t===e?t.classList.remove("d-none"):t.classList.add("d-none")}))};return{init:function(){t=document.querySelector("#password-auth-icon"),o=document.querySelector("#social-auth-icon"),e=document.querySelector("#password-auth"),r=document.querySelector("#social-auth"),n=document.querySelector("#login_form"),a=document.querySelector("#login_submit"),i=document.querySelector("#error-alert"),s=document.querySelector("#error-head"),d=document.querySelector("#error-body"),t.addEventListener("click",(function(n){n.preventDefault(),c(t,[t,o]),u(e,[e,r])})),o.addEventListener("click",(function(n){n.preventDefault(),c(o,[t,o]),u(r,[e,r])})),l=FormValidation.formValidation(n,{fields:{login:{validators:{notEmpty:{message:"Логин обязателен"}}},password:{validators:{notEmpty:{message:"Пароль обязателен"}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap:new FormValidation.plugins.Bootstrap5({rowSelector:".fv-row",eleInvalidClass:"",eleValidClass:""})}}),a.addEventListener("click",(function(e){e.preventDefault(),l.validate().then((function(e){"Valid"===e?(a.setAttribute("data-indicator","on"),a.disabled=!0,axios.post("/login",{login:n.querySelector('[name="login"]').value,password:n.querySelector('[name="password"]').value}).then((function(e){a.removeAttribute("data-indicator"),a.disabled=!1,e.data&&200==e.data.status?(console.error(e),n.querySelector('[name="login"]').value="",n.querySelector('[name="password"]').value="",location.href="/"):(console.error(e.data.error,e.data.traces),e.data.error_head&&(s.innerHTML=e.data.error_head),e.data.error&&(d.innerHTML=e.data.error),i.classList.remove("d-none"))})).catch((function(e){console.error(response),a.removeAttribute("data-indicator"),a.disabled=!1,s.innerHTML="Ошибка связи с сервером",d.innerHTML="Проверьте соединение с интернетом или обратитесь к администрации",i.classList.remove("d-none")}))):(s.innerHTML="Ошибка запроса",d.innerHTML="Проверьте введённые данные",i.classList.remove("d-none"))}))}))}}}();Util.onDOMContentLoaded((function(){LoginAuth.init()}));
//# sourceMappingURL=login.js.map
