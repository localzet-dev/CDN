"use strict";var FIDOAuth=function(){var t,n=function(t){let r="=?BINARY?B?",e="?=";if("object"==typeof t)for(let o in t)if("string"==typeof t[o]){let n=t[o];if(n.substring(0,r.length)===r&&n.substring(n.length-e.length)===e){n=n.substring(r.length,n.length-e.length);let a=window.atob(n),i=a.length,s=new Uint8Array(i);for(let t=0;t<i;t++)s[t]=a.charCodeAt(t);t[o]=s.buffer}}else n(t[o])},r=function(t){let n="",r=new Uint8Array(t),e=r.byteLength;for(let t=0;t<e;t++)n+=String.fromCharCode(r[t]);return window.btoa(n)};return{init:function(){try{t=document.getElementById("fido_verify"),(navigator.credentials&&navigator.credentials.create||(swal.fire({text:"Браузер не поддерживается",icon:"error",buttonsStyling:!1,confirmButtonText:"Хорошо!",customClass:{confirmButton:"btn fw-bold btn-light-primary"}}),0))&&t.addEventListener("click",(function(t){t.preventDefault(),axios.get("/fido/verify").then((async function(t){if(t.data.data&&200==t.data.status){console.log(t.data.data),n(t.data.data);const e=await navigator.credentials.get(t.data.data),o={id:e.rawId?r(e.rawId):null,clientDataJSON:e.response.clientDataJSON?r(e.response.clientDataJSON):null,authenticatorData:e.response.authenticatorData?r(e.response.authenticatorData):null,signature:e.response.signature?r(e.response.signature):null,userHandle:e.response.userHandle?r(e.response.userHandle):null};axios.post("/fido/verify",o).then((function(t){t.data.data&&200==t.data.status?(console.log(t.data.data),location.href="/"):(console.error(t.data.error,t.data.traces),swal.fire({text:t.data.error??"Неизвестная ошибка",icon:"error",buttonsStyling:!1,confirmButtonText:"Хорошо!",customClass:{confirmButton:"btn fw-bold btn-light-primary"}}))})).catch((function(t){console.error(t),swal.fire({text:"Ошибка FIDO: "+t,icon:"error",buttonsStyling:!1,confirmButtonText:"Хорошо!",customClass:{confirmButton:"btn fw-bold btn-light-primary"}})}))}else console.error(t.data.error,t.data.traces),swal.fire({text:t.data.error??"Неизвестная ошибка",icon:"error",buttonsStyling:!1,confirmButtonText:"Хорошо!",customClass:{confirmButton:"btn fw-bold btn-light-primary"}})})).catch((function(t){console.error(t),swal.fire({text:"Ошибка FIDO: "+t,icon:"error",buttonsStyling:!1,confirmButtonText:"Хорошо!",customClass:{confirmButton:"btn fw-bold btn-light-primary"}})}))}))}catch(t){return swal.fire({text:t,icon:"error",buttonsStyling:!1,confirmButtonText:"Хорошо!",customClass:{confirmButton:"btn fw-bold btn-light-primary"}}),!1}}}}();Util.onDOMContentLoaded((function(){FIDOAuth.init()}));
//# sourceMappingURL=fido.js.map
